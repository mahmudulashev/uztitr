<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>


  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@200..900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">

  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet">




  <title>Media Hub</title>
  <link rel="stylesheet" href="media-style.css">
</head>
<body>
   <!-- Header -->
   <header>
    <div class="header-wrapper">
      <div class="logo">
        <a href="./index.html"><h2>FOR MYSELF</h2></a>
      </div>


      <nav>
        <a href="./media.html"><svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 15C8.68629 15 6 12.3137 6 9V3.44444C6 3.0306 6 2.82367 6.06031 2.65798C6.16141 2.38021 6.38021 2.16141 6.65798 2.06031C6.82367 2 7.0306 2 7.44444 2H16.5556C16.9694 2 17.1763 2 17.342 2.06031C17.6198 2.16141 17.8386 2.38021 17.9397 2.65798C18 2.82367 18 3.0306 18 3.44444V9C18 12.3137 15.3137 15 12 15ZM12 15V18M18 4H20.5C20.9659 4 21.1989 4 21.3827 4.07612C21.6277 4.17761 21.8224 4.37229 21.9239 4.61732C22 4.80109 22 5.03406 22 5.5V6C22 6.92997 22 7.39496 21.8978 7.77646C21.6204 8.81173 20.8117 9.62038 19.7765 9.89778C19.395 10 18.93 10 18 10M6 4H3.5C3.03406 4 2.80109 4 2.61732 4.07612C2.37229 4.17761 2.17761 4.37229 2.07612 4.61732C2 4.80109 2 5.03406 2 5.5V6C2 6.92997 2 7.39496 2.10222 7.77646C2.37962 8.81173 3.18827 9.62038 4.22354 9.89778C4.60504 10 5.07003 10 6 10M7.44444 22H16.5556C16.801 22 17 21.801 17 21.5556C17 19.5919 15.4081 18 13.4444 18H10.5556C8.59188 18 7 19.5919 7 21.5556C7 21.801 7.19898 22 7.44444 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg> Tavsiyalar</a>
        <a href="#" onclick="setCategory('movies')"><svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 2V6M7 16V20M17 4V8M17 18V22M2 6H12M2 16H12M12 8H22M12 18H22M12 20V3.6C12 3.03995 12 2.75992 11.891 2.54601C11.7951 2.35785 11.6422 2.20487 11.454 2.10899C11.2401 2 10.9601 2 10.4 2H6.8C5.11984 2 4.27976 2 3.63803 2.32698C3.07354 2.6146 2.6146 3.07354 2.32698 3.63803C2 4.27976 2 5.11984 2 6.8V15.2C2 16.8802 2 17.7202 2.32698 18.362C2.6146 18.9265 3.07354 19.3854 3.63803 19.673C4.27976 20 5.11984 20 6.8 20H12ZM12 4H17.2C18.8802 4 19.7202 4 20.362 4.32698C20.9265 4.6146 21.3854 5.07354 21.673 5.63803C22 6.27976 22 7.11984 22 8.8V17.2C22 18.8802 22 19.7202 21.673 20.362C21.3854 20.9265 20.9265 21.3854 20.362 21.673C19.7202 22 18.8802 22 17.2 22H13.6C13.0399 22 12.7599 22 12.546 21.891C12.3578 21.7951 12.2049 21.6422 12.109 21.454C12 21.2401 12 20.9601 12 20.4V4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg> Filmlar</a>
        <a href="#" onclick="setCategory('series')"><svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M17 3L12 7L7 3M6.8 21H17.2C18.8802 21 19.7202 21 20.362 20.673C20.9265 20.3854 21.3854 19.9265 21.673 19.362C22 18.7202 22 17.8802 22 16.2V11.8C22 10.1198 22 9.27976 21.673 8.63803C21.3854 8.07354 20.9265 7.6146 20.362 7.32698C19.7202 7 18.8802 7 17.2 7H6.8C5.11984 7 4.27976 7 3.63803 7.32698C3.07354 7.6146 2.6146 8.07354 2.32698 8.63803C2 9.27976 2 10.1198 2 11.8V16.2C2 17.8802 2 18.7202 2.32698 19.362C2.6146 19.9265 3.07354 20.3854 3.63803 20.673C4.27976 21 5.11984 21 6.8 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg> Seriallar</a>
        <a href="#" onclick="showSavedList('watchlist')"><svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M21 5L10 5M21 19L10 19M21 12L10 12M6 5C6 5.82843 5.32843 6.5 4.5 6.5C3.67157 6.5 3 5.82843 3 5C3 4.17157 3.67157 3.5 4.5 3.5C5.32843 3.5 6 4.17157 6 5ZM6 19C6 19.8284 5.32843 20.5 4.5 20.5C3.67157 20.5 3 19.8284 3 19C3 18.1716 3.67157 17.5 4.5 17.5C5.32843 17.5 6 18.1716 6 19ZM6 12C6 12.8284 5.32843 13.5 4.5 13.5C3.67157 13.5 3 12.8284 3 12C3 11.1716 3.67157 10.5 4.5 10.5C5.32843 10.5 6 11.1716 6 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg> Kuzatuv roʻyxatim</a>
        <a href="#" onclick="showSavedList('seenList')"><svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M9 11L12 14L22 4M16 3H7.8C6.11984 3 5.27976 3 4.63803 3.32698C4.07354 3.6146 3.6146 4.07354 3.32698 4.63803C3 5.27976 3 6.11984 3 7.8V16.2C3 17.8802 3 18.7202 3.32698 19.362C3.6146 19.9265 4.07354 20.3854 4.63803 20.673C5.27976 21 6.11984 21 7.8 21H16.2C17.8802 21 18.7202 21 19.362 20.673C19.9265 20.3854 20.3854 19.9265 20.673 19.362C21 18.7202 21 17.8802 21 16.2V12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg> Ko‘rilganlar</a>
         
        
      </nav>

      <div class="input">
        <label for="searchInput"><svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M21 21L16.65 16.65M11 6C13.7614 6 16 8.23858 16 11M19 11C19 15.4183 15.4183 19 11 19C6.58172 19 3 15.4183 3 11C3 6.58172 6.58172 3 11 3C15.4183 3 19 6.58172 19 11Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg></label>
      <input type="text" id="searchInput" placeholder="Qidirish..." onkeyup="searchAll()" /> </div>
    </div>
  </header>
 
  <div id="content" class="grid"></div>
  <div class="pagination" id="pagination"></div>















  
<script>


  const API_KEY = 'c31fbe3cd0f434bf9aa13ca577150f7d'; 
  let currentCategory = 'movies';
  let currentPage = 1;
  let totalPages = 1;

  function setCategory(category) {
    currentCategory = category;
    currentPage = 1;
    loadData();
  }

  function loadData() {
    const url = currentCategory === 'movies'
      ? `https://api.themoviedb.org/3/discover/movie?api_key=${API_KEY}&sort_by=vote_average.desc&vote_count.gte=500&page=${currentPage}`
      : `https://api.themoviedb.org/3/discover/tv?api_key=${API_KEY}&sort_by=vote_average.desc&vote_count.gte=500&page=${currentPage}`;

    fetch(url)
      .then(res => res.json())
      .then(data => {
        totalPages = data.total_pages;
        showList(data.results); // Ma'lumotlarni interfeysga chiqarish
        renderPagination(); // Sahifalashni ko'rsatish
      })
      .catch(err => console.error('Ma\'lumotlarni yuklashda xatolik:', err));
  }

  function showList(items, fromList = null) {
    const content = document.getElementById('content');
    content.className = 'grid';
    content.innerHTML = '';

    items.forEach(item => {
      const title = item.title || item.name;
      const poster = item.poster_path ? `https://image.tmdb.org/t/p/w500${item.poster_path}` : '';
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <img src="${poster}" alt="Poster" onclick="showDetails(${JSON.stringify(item).replace(/"/g, '&quot;')})">
        <h3>${title}</h3>
        ${fromList ? `<button data-action="remove" data-list="${fromList}" data-id="${item.id}"><svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
 <path d="M16 6V5.2C16 4.0799 16 3.51984 15.782 3.09202C15.5903 2.71569 15.2843 2.40973 14.908 2.21799C14.4802 2 13.9201 2 12.8 2H11.2C10.0799 2 9.51984 2 9.09202 2.21799C8.71569 2.40973 8.40973 2.71569 8.21799 3.09202C8 3.51984 8 4.0799 8 5.2V6M10 11.5V16.5M14 11.5V16.5M3 6H21M19 6V17.2C19 18.8802 19 19.7202 18.673 20.362C18.3854 20.9265 17.9265 21.3854 17.362 21.673C16.7202 22 15.8802 22 14.2 22H9.8C8.11984 22 7.27976 22 6.63803 21.673C6.07354 21.3854 5.6146 20.9265 5.32698 20.362C5 19.7202 5 18.8802 5 17.2V6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
 </svg></button>` : ''} 
      `;
      content.appendChild(card);
    });

    // Remove button event listener
    document.querySelectorAll('[data-action="remove"]').forEach(button => {
      button.addEventListener('click', (event) => {
        event.stopPropagation(); // `showDetails` funksiyasini to'xtatish
        const listName = button.getAttribute('data-list');
        const id = parseInt(button.getAttribute('data-id'), 10);
        removeFromList(listName, id);
      });
    });
  }

  let currentItem = null;

  function showDetails(item) {
    currentItem = item;
    const title = item.title || item.name;
    const poster = item.poster_path ? `https://image.tmdb.org/t/p/w500${item.poster_path}` : '';
    const overview = item.overview || 'Hech qanday ma’lumot yo‘q';
    const year = item.release_date || item.first_air_date || 'Noma’lum';
    const rating = item.vote_average || 'Noma’lum';
    const votes = item.vote_count || '0';

    const content = document.getElementById('content');
    content.className = 'page';
    content.innerHTML = `
      <div class="details" id="details">
        <img src="${poster}" alt="Poster">
        <h2>${title}</h2>
        <div class="meta">
          <p>
            <svg width="100%" height="100%" viewBox="0 0 24 24" fill="#fff" xmlns="http://www.w3.org/2000/svg">
              <path d="M21 10H3M16 2V6M8 2V6M7.8 22H16.2C17.8802 22 18.7202 22 19.362 21.673C19.9265 21.3854 20.3854 20.9265 20.673 20.362C21 19.7202 21 18.8802 21 17.2V8.8C21 7.11984 21 6.27976 20.673 5.63803C20.3854 5.07354 19.9265 4.6146 19.362 4.32698C18.7202 4 17.8802 4 16.2 4H7.8C6.11984 4 5.27976 4 4.63803 4.32698C4.07354 4.6146 3.6146 5.07354 3.32698 5.63803C3 6.27976 3 7.11984 3 8.8V17.2C3 18.8802 3 19.7202 3.32698 20.362C3.6146 20.9265 4.07354 21.3854 4.63803 21.673C5.27976 22 6.11984 22 7.8 22Z" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <strong>Chiqarilgan Yili:</strong> ${year}
          </p>
          <p>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 48 48" id="Theater-Mask--Streamline-Plump" height="48" width="48">
              <path d="M5.44709 2.50148C7.61365 2.02234 11.6492 1.5 19 1.5c7.3508 0 11.3863 0.52234 13.5529 1.00148 2.0483 0.453 3.2039 2.17268 3.414 3.98422 0.1157 0.99708 0.246 2.30855 0.3489 3.8506 -1.2119 -0.36549 -2.5446 -0.74518 -4.0104 -1.13793C25.0906 7.26518 20.8263 6.6698 18.311 6.55868c-3.6364 -0.16066 -6.2123 2.23739 -7.2503 4.85672 -0.7845 1.98 -1.9776 5.2438 -3.03436 9.1877 -0.88585 3.306 -1.07437 6.7368 -0.57731 10.0526C3.63576 26.7591 1.5 21.3947 1.5 15.8c0 -3.9385 0.29719 -7.28046 0.53309 -9.3143 0.21012 -1.81154 1.36566 -3.53122 3.414 -3.98422ZM31.5283 12.0966C24.428 10.1941 20.3948 9.65415 18.178 9.55622c-2.0958 -0.0926 -3.657 1.26938 -4.3288 2.96488 -0.7543 1.9035 -1.9063 5.0547 -2.9257 8.8589 -2.00303 7.4755 0.0556 15.583 5.852 20.8449 1.7885 1.6236 3.836 3.1812 5.6942 3.6791 1.8582 0.4979 4.4102 0.1727 6.7708 -0.3391 7.6508 -1.6587 13.4874 -7.6507 15.4904 -15.1262 1.0194 -3.8043 1.5973 -7.1093 1.8958 -9.1349 0.2659 -1.8042 -0.4052 -3.7644 -2.2664 -4.7321 -1.9688 -1.0235 -5.7316 -2.5726 -12.832 -4.4751Z" clip-rule="evenodd" stroke-width="1"></path>
            </svg>
            <strong>Janrlari:</strong> <span id="genres">Noma’lum</span>
          </p>
        </div>
        <div class="wrapper">
          <div class="qisqacha">
            <p><strong>Qisqacha:</strong> ${overview}</p>
            <hr>
            <div id="extraInfo">
              <p><strong>Rejissyor:</strong> Noma’lum</p>
              <p><strong>Fasllar:</strong> Noma’lum</p>
              <p><strong>Epizodlar:</strong> Noma’lum</p>
            </div>
          </div>

          <div class="reyting">
            <p><strong>Reyting:</strong> ${rating}</p>
            <p><strong>Ovozlar:</strong> ${votes}</p>
            <div class="buttons">
              <button onclick="addToList('watchlist')">⭐ Watchlist</button>
              <button onclick="addToList('seenList')">✅ Ko‘rganman</button>
            </div>
          </div>
        </div>
      </div>
    `;

    // Sahifalashni yangilash
    renderPagination(true, item.media_type || (item.first_air_date ? 'tv' : 'movie'));
  }

  function saveRating() {
    const rating = document.getElementById('ratingSelect').value;
    if (rating !== '0') {
      const savedRatings = JSON.parse(localStorage.getItem('ratings')) || {};
      savedRatings[currentItem.id] = rating;
      localStorage.setItem('ratings', JSON.stringify(savedRatings));
      alert('Rating saqlandi!');
    } else {
      alert('Iltimos, rating tanlang!');
    }
  }


  function getSavedRating(itemId) {
    const savedRatings = JSON.parse(localStorage.getItem('ratings')) || {};
    return savedRatings[itemId] || null; 
  }
  

  function addToList(listName) {
    if (!currentItem) return;
  
    let list = JSON.parse(localStorage.getItem(listName)) || [];
  
    if (list.find(i => i.id === currentItem.id)) {
      alert("Bu allaqachon qo‘shilgan!");
      return;
    }
  
    list.push(currentItem);
    localStorage.setItem(listName, JSON.stringify(list));
    alert("Muvaffaqiyatli qo‘shildi!");
  }

  function showSavedList(listName) {
    const savedList = JSON.parse(localStorage.getItem(listName)) || [];
    showList(savedList, listName); // Ro'yxatni interfeysga chiqarish
    document.getElementById('pagination').innerHTML = ''; // Sahifalashni tozalash
  }

  function removeFromList(listName, id) {
    let list = JSON.parse(localStorage.getItem(listName)) || [];
    list = list.filter(item => item.id !== id); // Elementni o'chirish
    localStorage.setItem(listName, JSON.stringify(list)); // Yangilangan ro'yxatni saqlash

    // Faqat o'chirilgan ro'yxatni yangilash
    if (listName === 'watchlist' || listName === 'seenList') {
      showSavedList(listName); // Yangilangan ro'yxatni ko'rsatish
    }
  }

  function renderPagination(isDetailsPage = false, mediaType = null) {
    const pagination = document.getElementById('pagination');
    pagination.innerHTML = '';

    if (isDetailsPage) {
      // Back tugmasini qo'shish
      const backButton = document.createElement('button');
      backButton.innerHTML = `
        <svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M20 12H4M4 12L10 18M4 12L10 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      `;
      backButton.onclick = () => {
        if (mediaType === 'tv') {
          setCategory('series'); // Seriallar sahifasiga qaytish
        } else {
          setCategory('movies'); // Filmlar sahifasiga qaytish
        }
      };
      pagination.appendChild(backButton);
    } else {
      // Oddiy sahifalash
      const backButton = document.createElement('button');
      backButton.innerHTML = `
        <svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M20 12H4M4 12L10 18M4 12L10 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      `;
      backButton.disabled = currentPage === 1;
      backButton.onclick = () => {
        if (currentPage > 1) {
          currentPage--;
          loadData();
        }
      };
      pagination.appendChild(backButton);

      const pageIndicator = document.createElement('span');
      pageIndicator.innerText = ` ${currentPage} / ${totalPages}`;
      pageIndicator.style.margin = '0 10px';
      pagination.appendChild(pageIndicator);

      const nextButton = document.createElement('button');
      nextButton.innerHTML = `
        <svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 12H20M20 12L14 6M20 12L14 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      `;
      nextButton.disabled = currentPage === totalPages;
      nextButton.onclick = () => {
        if (currentPage < totalPages) {
          currentPage++;
          loadData();
        }
      };
      pagination.appendChild(nextButton);
    }
  }

  function searchAll() {
    const query = document.getElementById('searchInput').value.trim();
    if (query.length < 2) return;

    const url = currentCategory === 'movies'
      ? `https://api.themoviedb.org/3/search/movie?api_key=${API_KEY}&query=${encodeURIComponent(query)}`
      : `https://api.themoviedb.org/3/search/tv?api_key=${API_KEY}&query=${encodeURIComponent(query)}`;

    fetch(url)
      .then(res => res.json())
      .then(data => {
        totalPages = 1;
        showList(data.results);
        document.getElementById('pagination').innerHTML = '';
      });
  }


  document.addEventListener('DOMContentLoaded', () => {
    setCategory('movies'); // Filmlar avtomatik yuklanadi
    loadData(); // Ma'lumotlarni yuklash
  });
  


  

</script>
</body>
</html>
